<h1 class="recipeName"><%= @recipe.name %></h1>
<p>by <%= link_to @recipe.user.email, user_path(@recipe.user) %></p>

<h2>Description</h2>
<p class='recipeDescription'><%= @recipe.description %></p>

<h2>Ingredients</h2>
<ul>
	<% @recipe.recipe_ingredients.each do |ri| %>
	  <li><%= ri.ingredient.name %> -
	  <%= ri.quantity %> units</li>
<% end %>
</ul>

<h2>Instructions</h2>
<p class='recipeInstructions'><%= @recipe.instructions %></p>

<a href="#" class='js-next' data-id='<%= @recipe.id %>'>Next recipe...</a>

<!-- <h1>Repeat issue</h1>
<div id="recipe_handlebars"></div> -->

<h3>Comments</h3>

<%= form_for :comment do |f| %>

<%= f.label :body, 'New comment' %><br>
<%= f.text_area :body %><br>

<%= f.submit %>

<% end %>

<script type="text/javascript" charset="utf-8">
  $(function () {
    $('form').submit(function(event) {
      //prevent form from submitting the default way
      event.preventDefault();

      var values = $(this).serialize();

      var posting = $.post('/comments', values);

      posting.done(function(data) {
        $("#comment_body").text(["title"]);
        $("#postBody").text(post["description"]);
      });
    });
  });
</script>


<script type="text/javascript">
$(() => {
  $(".js-next").on("click", function(e) {
		e.preventDefault();
    var nextId = parseInt($(".js-next").attr("data-id")) + 1;
    $.get("/recipes/" + nextId + '.json', (data) => {
			$('.recipeName').html(data['name']);
			$('.recipeDescription').html(data['description']);

			// This does not work. Need to figure out how to show ingredients.
			$(data.recipe_ingredients).each( function(ri) {
				console.log(ri['quantity'] + ' units');
			});
      $('.recipeInstructions').html(data['instructions']);
      // re-set the id to current on the link
      $('.js-next').attr('data-id', data['id']);
    });
  });
});
</script>

<!-- <h3>Ingredients</h3>
<ul>
	<% @recipe.recipe_ingredients.each do |ri| %>
	<li><%= ri.ingredient.name %> -
		<%= ri.quantity %> units</li>
		<% end %>
	</ul> -->


	<!-- <script type="text/javascript">
	$(() => {
		$('.js-next').on('click', function(e) {
			e.preventDefault;
			nextRecipe();
		})
	})
	</script>

	<script id="recipe-template" type="text/x-handlebars-template">
		<h1 {{name}}</h1>
		<h3>Description</h3>
		<p {{description}}</p>

		<h3>Instructions</h3>
		<p class='recipeInstructions'><%= @recipe.instructions %></p>
	</script> -->
